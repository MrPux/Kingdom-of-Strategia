<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Metadata for the HTML document -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Kingdom of Strategia</title>

    <link rel="stylesheet" href="/css/style.css">
</head>

<body>

    <!-- Header Section -->
    <header>
        <nav>
            <h1>Kingdom of Strategia</h1>
        </nav>
    </header>

    <!-- Main Container -->
    <div id="container">

        <!-- Map Wrapper -->
        <div id="map-wrapper">
            <!-- Map Area -->
            <div id="map">

                <!-- Village Action Button -->
                <button id="village-action-btn" style="
                    position: absolute;
                    z-index: 10;
                    display: none;
                    padding: 5px 10px;
                    background-color: rgba(0, 102, 110, 0.517);
                    color: white;
                    border: none;
                    border-radius: 5px;
                    cursor: pointer;
                ">
                    View
                </button>

                <!-- Village Tooltip -->
                <div id="village-tooltip" style="
                    position: absolute;
                    display: none;
                    padding: 8px 12px;
                    background-color: #444;
                    color: white;
                    font-size: 14px;
                    border-radius: 5px;
                    z-index: 9;
                    white-space: nowrap;
                    transform: translate(-50%, -100%);
">
                    <span id="tooltip-text">Village</span>
                    <div style="
                        position: absolute;
                        bottom: -8px;
                        left: 50%;
                        transform: translateX(-50%);
                        width: 0;
                        height: 0;
                        border-left: 8px solid transparent;
                        border-right: 8px solid transparent;
                        border-top: 8px solid #444;
                    "></div>
                </div>

                <!-- Enemy Tooltip -->
                <div id="enemy-tooltip" style="
                    position: absolute;
                    display: none;
                    padding: 6px 10px;
                    background-color: rgba(180, 0, 0, 0.85);
                    color: white;
                    font-size: 13px;
                    border-radius: 6px;
                    white-space: nowrap;
                    transform: translate(-50%, -100%);
                    z-index: 11;
                    pointer-events: none;
                    box-shadow: 0 0 6px rgba(0,0,0,0.3);
                ">
                    <span id="enemy-tooltip-text">Lvl 1</span>
                </div>



                <!-- Game Lines (Roads) -->
                <svg id="game-lines">
                    <th:block th:each="road : ${roads}">
                        <th:block th:if="${road != null and road.fromVillage != null and road.toVillage != null}">
                            <text th:attr="x=${(road.fromVillage.xCoordinate + road.toVillage.xCoordinate) / 2},
                                           y=${(road.fromVillage.yCoordinate + road.toVillage.yCoordinate) / 2 - 10}"
                                font-size="12" fill="black" th:text="'W: ' + ${road.weight}"></text>
                            <line th:attr="x1=${road.fromVillage.xCoordinate + 30},
                                           y1=${road.fromVillage.yCoordinate + 30},
                                           x2=${road.toVillage.xCoordinate + 30},
                                           y2=${road.toVillage.yCoordinate + 30}" stroke="white" stroke-width="5" />
                        </th:block>
                    </th:block>
                </svg>

                <!-- Mountains -->
                <th:block th:each="mountain : ${mountains}">
                    <img th:src="@{/assets/mountains/{file}(file=${mountain.sprite})}"
                        th:style="'left: ' + ${mountain.XCoordinate} + 'px; top: ' + ${mountain.YCoordinate} + 'px;'"
                        width="60" height="60" />

                </th:block>

                <!-- Villages -->
                <th:block th:each="village : ${villages}">
                    <img class="village-img" th:src="@{${village.sprite}}" th:data-village-id="${village.id}"
                        th:data-population="${village.population}" th:data-structures="${village.structures}"
                        th:data-x="${village.xCoordinate}" th:data-y="${village.yCoordinate}"
                        th:style="'left: ' + ${village.XCoordinate} + 'px; top: ' + ${village.YCoordinate} + 'px;' + (${village.id == startingVillage.id} ? 'border: 5px solid green;' : '')"
                        width="60" height="50" />

                </th:block>

                <!-- Enemies -->
                <!-- Corrected enemy rendering block -->
                <th:block th:each="enemy : ${enemies}">
                    <img class="enemy-img" th:src="@{/assets/enemies/{file}(file=${enemy.sprite})}"
                        th:data-level="${enemy.level}"
                        th:style="'left: ' + ${enemy.xCoordinate} + 'px; top: ' + ${enemy.yCoordinate} + 'px;'"
                        width="30" height="30" />
                </th:block>




                <img id="spyglass-overlay" src="/assets/spyglass.png" alt="Spyglass View"
                    style="width: 100%; height: 100%;" />
            </div>
        </div>

        <!-- Sidebar -->
        <div id="sidebar">
            <h2>Controls</h2>
            <h5>ZOOM IN - "double click"</h5>
            <h5>ZOOM OUT - "double click"</h5>
            <h2>______________________</h2>
            <h2>Resources Collected</h2>

            <div
                style="background-color: rgba(0, 102, 110, 0.517); padding-left: 20px; padding-top:5px; padding-bottom:5px; border-radius: 25px;">
                <p><strong>üß∫ Total Food:</strong> <span id="total-food">0</span></p>
                <p><strong>ü™µ Total Wood:</strong> <span id="total-wood">0</span> </p>
                <p><strong>ü™® Total Rocks:</strong> <span id="total-rocks">0</span> </p>
                <p><strong>‚õèÔ∏è Total Iron:</strong> <span id="total-iron">0</span></p>
                <p><strong>üõ¢Ô∏è Total Coal:</strong><span id="total-coal">0</span></p>
                <p><strong>üë®‚Äçüåæ Total Villagers:</strong> <span id="total-villagers">0</span></p>
                <p><strong>üõ°Ô∏è Total Knights:</strong> <span id="total-knights">0</span></p>
            </div>
            <h2>______________________</h2>
            <h2>Table Info</h2>
            <ul>
                <li th:each="road : ${roads}" th:text="'From (' + ${road.fromVillage.XCoordinate} + ', ' + ${road.fromVillage.YCoordinate} +
                                ') To (' + ${road.toVillage.XCoordinate} + ', ' + ${road.toVillage.YCoordinate} +
                                ') W: ' + ${road.weight}">
                </li>
            </ul>
            <h2>______________________</h2>
            <p>Don't Click unless to you wanna see your <br> progress reset or have finished <br>the current map, I have
                this button for <br> Dr. Patterson to see new generations<br> and to know its not just one type,
                <br>there could be others depending in cords <br>villages spawn.</p>
            <form action="/empty" method="post">
                <button type="submit">New Gen</button>
            </form>
        </div>
    </div>
    <!--  -->

    <!-- JavaScript Section -->
    <!-- Loading the main JavaScript file -->
    <script th:src="@{/js/index.js}"></script>
</body>

</html>